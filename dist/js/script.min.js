"use strict";function testWebP(e){var t=new Image;t.onload=t.onerror=function(){e(2==t.height)},t.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}testWebP((function(e){1==e?document.querySelector("body").classList.add("webp"):document.querySelector("body").classList.add("no-webp")}));const body=document.querySelector("body");let iter=0;const menus=document.querySelectorAll("#menu");if(menus.length>0)for(let e=0;e<menus.length;e++){let t=menus[e];t.addEventListener("click",(e=>{if(e.target.closest("#men")){let e=Array.from(t.childNodes).filter((e=>!(null==e.classList)));for(let t=0;t<e.length;t++){let o=e[t].classList;o.contains("dropdown__menu")&&(o.toggle("dropdown__menu-open"),body.addEventListener("click",(e=>{e.target.closest(".dropdown__menu")||e.target.closest(".header__menu-cont")||o.remove("dropdown__menu-open")})))}}if(e.target.closest("#lang")){console.log("Привет, должно открыться меню");let e=Array.from(t.childNodes).filter((e=>!(null==e.classList)));console.log(e);for(let t=0;t<e.length;t++){let o=e[t].classList;o.contains("dropdown__lang")&&(o.toggle("lang-open"),body.addEventListener("click",(e=>{e.target.closest(".dropdown__lang")||e.target.closest(".header__menu-cont")||o.remove("lang-open")})))}}}))}const popupLinks=document.querySelectorAll(".popup__open"),html=document.querySelector("html");if(popupLinks.length>0)for(let e=0;e<popupLinks.length;e++){const t=popupLinks[e];t.addEventListener("click",(e=>{e.preventDefault();const o=t.getAttribute("href").replace("#","");popupOpen(document.querySelector("."+o),o)}))}function popupOpen(e,t){let o=document.querySelector(".popup-open");o&&o.classList.remove("popup-open"),e.classList.add("popup-open"),body.style.overflow="hidden",html.style.overflow="hidden",e.addEventListener("click",(o=>{!o.target.classList.contains("close")&&o.target.closest("."+t+"-container")||(e.classList.remove("popup-open"),body.style.overflow="auto",html.style.overflow="auto")}))}const bigForm=document.querySelector("#bform"),popupForm=document.querySelector("#pform"),smallForm=document.querySelector("#sform"),formFiles=document.querySelector(".feedback__form__file-input"),formPreview=document.querySelector(".feedback__form__files-preview");let filesArr=[];function formsWork(e,t,o){if(e.addEventListener("submit",(async function(t){t.preventDefault();let n=function(e){let t=0,o=e.querySelectorAll("._req");for(let e=0;e<o.length;e++){const n=o[e];n.addEventListener("input",(()=>{n.classList.remove("_error")})),formRemoveError(n),n.classList.contains("_email")?emailTest(n)&&(formAddError(n),t++):("checkbox"===n.getAttribute("type")&&!1===n.checked||""===n.value)&&(formAddError(n),t++)}return t}(e),r=new FormData(e);if(filesArr.length>0)for(let e=0;e<filesArr.length;e++)r.append(`file_${e}`,filesArr[e]);if(0===n){e.classList.add("_sending");let t=await fetch(o,{method:"POST",body:r});if(t.ok){let o=await t.json();popupOpen(document.querySelector(".popup__thanks"),"popup__thanks"),console.log(o),formPreview&&(formPreview.innerHTML=""),e.reset(),e.classList.remove("_sending")}else e.classList.remove("_sending"),alert("Ошибка")}else{document.querySelectorAll("._error")[0].scrollIntoView({block:"center",inline:"center"})}})),t){function e(e){for(let t=0;t<e.length;t++){let o=e[t];if("docx"!==fileName(o)&&"jpeg"!==fileName(o)&&"pdf"!==fileName(o)&&"jpg"!==fileName(o)&&"png"!==fileName(o)&&"txt"!==fileName)return alert("Разрешены только файлы с расширениями docx, картинки, pdf, txt"),void(formFiles.value="");if(o.size>3145728)return void alert("Файл должен быть меньше 3 МБ");formPreview.innerHTML.includes(o.name)||(formPreview.innerHTML+=`<span class='filePreview-span'>${o.name}, </span><br>`,filesArr.push(o))}}formFiles&&formFiles.addEventListener("change",(()=>{e(formFiles.files)}))}}function fileName(e){return e.name.substring(e.name.lastIndexOf(".")+1,e.name.length)||e.name}function formAddError(e){e.classList.add("_error")}function formRemoveError(e){e.classList.remove("_error")}function emailTest(e){return!/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(e.value)}bigForm&&formsWork(bigForm,!0,"sendmail.php"),popupForm&&formsWork(popupForm,!1,"sendmail-small.php"),smallForm&&formsWork(smallForm,!1,"sendmail-popup.php");let phoneInputs=document.querySelectorAll("input[data-tel-input]");for(let e=0;e<phoneInputs.length;e++){let t=phoneInputs[e];t.addEventListener("input",onPhoneInput),t.addEventListener("keydown",inputBackspace)}function onPhoneInput(e){let t=e.target,o=getInputNumbersValue(t),n="",r=t.selectionStart;if(!o)return t.value="+";if(t.value.length==r){if(!(["7"].indexOf(o[0])>-1||["8"].indexOf(o[0])>-1))return t.value="+"+o.substring(0,16);n="+7"+" ",o.length>1&&(n+="("+o.substring(1,4)),o.length>4&&(n+=") "+o.substring(4,7)),o.length>7&&(n+="-"+o.substring(7,9)),o.length>9&&(n+="-"+o.substring(9,11));t.value=n}else e.data&&/\D/g.test(e.data)&&(t.value=o)}function getInputNumbersValue(e){return"+"!==e.value?e.value.replace(/\D/g,""):void 0}function inputBackspace(e){let t=e.target;8==e.keyCode&&2==getInputNumbersValue(t).length&&(t.value="")}let a=NaN,b=NaN;console.log(a===b);